# 桃園市土地使用查詢爬蟲工具

## 📌 概述

透過爬蟲功能查詢桃園市政府土地使用分區系統 (https://landuse.tycg.gov.tw/sys/QueryProgress/QueryProgress.aspx) 的地號資料。使用者可透過網頁輸入地號，系統將自動查詢至最新地號，並可下載查詢結果的 Excel 檔案。

<br>

## 📌 功能

- 提供一個簡易的網頁界面，使用者輸入起始地號進行查詢。
- 透過爬蟲自動爬取桃園市政府的土地使用分區系統資料。
- 支援下載查詢結果為 Excel 格式。
- 提供重新查詢功能，可中止查詢並清除顯示結果。

<br>

## 📌 運作流程

1. **使用者輸入**：在網頁輸入地號，並點擊「開始查詢」按鈕。
2. **後端處理**：後端 Flask 服務接收請求，啟動爬蟲程式進行資料抓取。
3. **資料爬取**：`crawler.py` 執行爬蟲任務，抓取指定地號的資料，並動態更新前端界面。
4. **結果下載**：查詢完成後，使用者可下載 `output.xlsx` 檔案。
5. **重置功能**：使用者可選擇重新查詢，中止爬蟲並清除現有資料。

<br>

## 📌 專案架構

```bash
project/
├── app.py                 # Flask 主程式
├── crawler.py             # 爬蟲程式
├── templates/
│   └── index.html         # 前端 HTML 頁面
└── output.xlsx            # 查詢結果 (自動生成)
```

<br>

## 📌 環境設定及運行指令

### 1. 環境設定

* 確保系統安裝了 Python 3。
* 安裝所需的 Python 套件：

```bash
pip install -r requirements.txt
```

`requirements.txt` 應包含以下套件：

* Flask
* socketio
* pandas
* selenium

<br>

### 2. 執行 Flask 伺服器

在專案目錄下執行以下指令啟動 Flask 伺服器：

```bash
python app.py
```

伺服器啟動後，可在瀏覽器中輸入以下網址訪問：

`http://localhost:5000`

<br>

### 3. 使用說明

* 在輸入框中輸入查詢地號（例如：`00001` 或 `38000`），點擊「開始查詢」按鈕。
* 查詢過程中，頁面會動態顯示爬蟲進度。
* 查詢完成後，點擊「下載結果」按鈕，即可下載查詢結果的 Excel 檔案。
* 若需重新查詢，點擊「重新查詢」按鈕，即可中止目前的爬蟲並清除現有資料。

<br>

## 📌 常見問題與錯誤排除

### 1. 無法啟動伺服器

請檢查是否已安裝所有必需的 Python 套件：

`pip install -r requirements.txt`

### 2. 查詢失敗或無法下載 Excel 檔案
* 確認輸入的地號格式是否正確，地號應為正整數，且不能為 `0`。
* 若資料檔案不存在，頁面會顯示錯誤訊息，請確認爬蟲是否成功完成。
### 3. 爬蟲被中止
* 使用「重新查詢」按鈕可中止目前的爬蟲，若仍無法重置，請重新啟動 Flask 伺服器。

<br>

## 📌 版本資訊

### v1.0

目前版本（v1.0）提供基本的查詢、爬蟲、動態顯示及 Excel 檔案下載功能。
